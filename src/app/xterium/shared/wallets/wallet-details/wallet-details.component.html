<div class="wallet-details">
  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <ion-list>
          <ion-item class="primary-input-item ion-margin-bottom" lines="none">
            <ion-label>Name:</ion-label>
            <ion-input type="text" placeholder="e.g. My Wallet Name" [(ngModel)]="wallet.name"
              (ngModelChange)="updateWalletOnModelChange()"></ion-input>
          </ion-item>
          <ion-item class="primary-textarea-item ion-margin-bottom" lines="none">
            <ion-label position="stacked">Public Address:</ion-label>
            <ion-textarea rows="3" placeholder="" readonly="true" [(ngModel)]="walletPublicKey"></ion-textarea>
          </ion-item>
          <ion-item class="primary-input-item ion-margin-bottom" lines="none">
            <ion-label>Chain:</ion-label>
            <ion-input type="text" placeholder="" [(ngModel)]="currentWallet.chain.name" readonly="true"
              (ngModelChange)="updateWalletOnModelChange()"></ion-input>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>
    <ion-row class="show-secrets ion-margin-top">
      <ion-col size="12">
        <ion-list>
          <ion-item button lines="none" class="ion-margin-bottom" (click)="signTransactions()" >
            <ion-label>
              <h2>Show Recovery Phrase</h2>
            </ion-label>
          </ion-item>
          <ion-item button lines="none">
            <ion-label>
              <h2>Show Private Key</h2>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>
    <ion-row class="ion-margin-top">
      <ion-col size="12">
        <div class="primary-button-wrapper">
          <ion-button expand="block" size="default" class="ion-margin-bottom secondary-button"
            (click)="copyToClipboard()">
            COPY ADDRESS
          </ion-button>
          <ion-button expand="block" size="default" class="ion-margin-bottom success-button" (click)="exportWallet()">
            EXPORT WALLET
          </ion-button>
          <ion-button expand="block" size="default" class="ion-margin-bottom danger-button" (click)="deleteWallet()"
            [disabled]="this.currentWallet.id === wallet.id">
            DELETE WALLET
          </ion-button>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-toast [duration]="5000"></ion-toast>
</div>

<ion-modal #confirmSignTransactionModal [initialBreakpoint]="0.98" [breakpoints]="[0, 0.98]" [expandToScroll]="false">
  <ng-template>
    <ion-toolbar class="main-modal-toolbar">
      <ion-title>Confirm Transaction</ion-title>
      <ion-buttons slot="end">
        <ion-button (click)="confirmSignTransactionModal.dismiss()">
          <ion-icon name="close" style="color: white;"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
    <ion-content>
      <div class="sign-transaction">
        <div class="ion-text-center ion-margin-bottom">
          <img alt="xterium" src="./../../../assets/icon/xterium-logo.png" class="logo" />
        </div>
        <div class="ion-text-center ion-padding-start ion-padding-end ion-padding-bottom">
          <h1 style="font-weight: bold">Sign</h1>
          <span style="font-size: 15px;">
            To confirm this transaction, please authenticate using the method you have set up for your wallet.
          </span>
        </div>
        <div class="ion-padding-horizontal">
          @if (isChromeExtension && currentAuth) {
          <app-password-login (onLogin)="confirmSignTransaction($event)"></app-password-login>
          } @else if (isChromeExtension && !currentAuth) {
          <app-password-setup (onPasswordSetup)="confirmSignTransaction($event)"></app-password-setup>
          } @else if (!isChromeExtension && isBiometricAvailable && (!currentAuth || currentAuth.type === 'biometric'))
          {
          <app-biometric (onLogin)="confirmSignTransaction($event)"></app-biometric>
          } @else if (!isChromeExtension && isBiometricAvailable && currentAuth?.type === 'pin') {
          <app-pin-login (onLogin)="confirmSignTransaction($event)"></app-pin-login>
          } @else if (!isChromeExtension && !isBiometricAvailable && currentAuth?.type === 'biometric') {
          <div class="biometric-unavailable">
            <p class="unavailable-text">
              You've previously set up biometric authentication, but it's currently unavailable on this device.
              Please set up your biometric authentication again to continue.
            </p>
          </div>
          } @else if (!isChromeExtension && !isBiometricAvailable && currentAuth?.type === 'pin') {
          <app-pin-login (onLogin)="confirmSignTransaction($event)"></app-pin-login>
          } @else {
          <app-pin-setup (onPasswordSetup)="confirmSignTransaction($event)"></app-pin-setup>
          }
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>

<ion-modal #mnemonicRecoveryModal [initialBreakpoint]="0.98" [breakpoints]="[0, 0.98]"
  [expandToScroll]="false">
  <ng-template>
    <ion-toolbar class="main-modal-toolbar">
      <ion-buttons slot="end">
        <ion-button (click)="mnemonicRecoveryModal.dismiss()">
          <ion-icon name="close" style="color: white;"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
    <ion-content>
      <div class="ion-padding-horizontal">
        <ion-grid>
          <ion-row>
            <ion-col size="12">
              <ion-card class="explore-card" color="danger">
                <h5 style="font-weight: bold;">Do not share your Recovery Phrase!</h5>
                <span style="font-size: 15px;">If someone has your Recovery Phrase they will have full controll of your wallet.</span>
              </ion-card>
            </ion-col>
          </ion-row>
          <ion-row>
            @for (word of walletMnemonicPhrase; track word; let index = $index) {
            <ion-col size="6">
              <ion-list>
                <ion-item class="primary-input-item">
                  <ion-input type="text" [(ngModel)]="walletMnemonicPhrase[index]" autocomplete="off"
                    readonly="true"></ion-input>
                </ion-item>
              </ion-list>
            </ion-col>
            }
          </ion-row>
          <ion-row class="ion-margin-top">
            <ion-col size="12">
              <div class="primary-button-wrapper">
                <ion-button expand="block" size="default" class="ion-margin-bottom secondary-button"
                  (click)="copyToClipboard()">
                  <ion-icon name="copy-outline" slot="start" [size]="'small'"></ion-icon>
                  COPY TO CLIPBOARD
                </ion-button>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>

        <ion-toast [duration]="5000"></ion-toast>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
